---
title: "Assignment 4 ggplot2"
author:
- familyname: Li
  othernames: Siyi
  address: Monash Universty
  email: "slii0048@student.monash.edu"
  correspondingauthor: true
  qualifications: 29018102
- familyname: Wang
  othernames: Yusen
  address: Monash Universty
  email: "ywa136@student.monash.edu"
  correspondingauthor: true
  qualifications: 27496538
- familyname: Tsakis
  othernames: Alexi
  address: Monash Universty
  email: "atsa0003@student.monash.edu"
  correspondingauthor: true
  qualifications: 29682525
department: Our consultancy \newline Alexi  &\newline Siyi  &\newline Yusen
organization: Australian Government
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    latex_engine: lualatex
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
    in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r , echo = FALSE, include=FALSE, message = FALSE, warning = FALSE}
# Libraries
set.seed(96024)

library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(fig.pos = 'H', echo = FALSE, message = FALSE, warning = FALSE)
```

{Section 1}

####Compulsory Seatbelts 1983

```{r, echo = FALSE, message = FALSE, warning = FALSE}
Seatbelts_data = data.frame(as.matrix(Seatbelts),date=time(Seatbelts))
```

```{r DriversKilled, fig.cap = "Drivers killed in accidents over time", echo = FALSE, message = FALSE, warning = FALSE}
ggplot(data=Seatbelts_data, aes(x=date,y=DriversKilled,col=law))+geom_line()+geom_smooth()
```

```{r FrontKilled, fig.cap = "Frontseat passengers killed in accidents over time", echo = FALSE, message = FALSE, warning = FALSE}
ggplot(data=Seatbelts_data, aes(x=date,y=front,col=law))+geom_line()+geom_smooth()
```

```{r RearKilled, fig.cap = "Backseat passengers killed in accidents over time", echo = FALSE, message = FALSE, warning = FALSE}
ggplot(data=Seatbelts_data, aes(x=date,y=rear,col=law))+geom_line()+geom_smooth()
```

```{r VanKilled, fig.cap = "Light goods vehicle drivers killed in accidents over time", echo = FALSE, message = FALSE, warning = FALSE}
ggplot(data=Seatbelts_data, aes(x=date,y=VanKilled,col=law))+geom_line()+geom_smooth()
```

```{r DriverTable, echo = FALSE, message = FALSE, warning = FALSE}
Seatbelts_data %>%
  group_by(law) %>%
  summarise(DriversKilled_Average=mean(DriversKilled)) %>%
  kable(caption="Drivers killed before and after law")
```

```{r RearTable, echo = FALSE, message = FALSE, warning = FALSE}
Seatbelts_data %>%
  group_by(law) %>%
  summarise(Rear_Average=mean(rear)) %>%
  kable(caption="Back seat passengers killed before and after law")
```

```{r FrontTable, echo = FALSE, message = FALSE, warning = FALSE}
Seatbelts_data %>%
  group_by(law) %>%
  summarise(Front_Average=mean(front)) %>%
  kable(caption="Front seat passengers killed before and after law")
```

```{r VanTable, echo = FALSE, message = FALSE, warning = FALSE}
Seatbelts_data %>%
  group_by(law) %>%
  summarise(Van_Average=mean(VanKilled)) %>%
  kable(caption="Light good vehicle drivers killed before and after law")
```

In this section we look at the effect of seatbelts on driver deaths in the UK. Front seatbelts were compulsory on all new cars registered in the UK from 1968, however it was not required for them to be worn until 1983. In this section, we will answer the question - did mandatory wearing of frontrow seatbelts prevent deaths for drivers and passengers?

First, to answer if any relationships shown are causation and not simply correlation, we ask - why do seatbelts prevent deaths? According to the National Highway Traffic Safety Administration, the primary reasons why seatbelts prevent death is that "Buckling up helps keep you safe and secure inside your vehicle, whereas not buckling up can result in being totally ejected from the vehicle in a crash, which is almost always deadly." (NHTSA 2021)

These scenarios are referred to as "secondary collisions" - i.e. a crash event that results from the impact of an initial collison, such as ejection from a vehicle, or even a high speed impact with objects inside the vehicle.

Now that we understand the theory behind the impact of seatbelts on preventing death, let us look at the data:

There is a clear negative correlation between frontrow passengers and light good vehicle drivers killed since the introduction of the law (figure \@ref(fig:FrontKilled),  figure \@ref(fig:VanKilled)), data from the introduction of the law shown in blue).

There is also a clear reduction in number of drivers killed (figure \@ref(fig:DriversKilled)) since the introduction of compulsory seatbelts - the lack of change since the introduction of the law, but the large change since approximately 1973 can be described as " drivers that are least likely to use seat belts might be those that are more likely to be involved in an accident" (Cohen, A. and Einav. L 2003) - i.e. that careful drivers adopted seatbelts already without the law, and those likely to get involved in accidents would be unlikely to wear seatbelts even with the law in place.

There is little change in number of rear seat passengers killed (figure \@ref(fig:RearKilled)) - this is because the regulations and law were only for front seat seatbelts, and not backseat seatbelts, suggesting the total number of accidents didn't change.

We can also see this in tabular format, so it is easier to see the effect of the law numerically (table \@ref(tab:DriverTable), table \@ref(tab:RearTable), table \@ref(tab:FrontTable), table \@ref(tab:VanTable)).

{Section 2}
```{r, message=FALSE, warning=FALSE}
library(ggplot2)
library(GGally)
```



```{r get-data}
Seatbelts%>%as.data.frame()->seatbelts
```
# Reaseach Questions

Is there any relationship between the DriversKilled variable and other variables?
Can we build an model among these variables?


# Analysis
## Is there any relationship between the DriversKilled variable and other variables?
```{r mytables, message=FALSE, warning=FALSE}
seatbelts%>%
  summary%>%
  kable(caption = "summary of all variabls")%>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```
From the table \@ref(tab:mytables) shows that the minimum number of drivers killed is 60 and the maximum is 198. It also presents that law is a binary variable. 

```{r ggpairs, warning=FALSE, message=FALSE, fig.cap = "Correlation between variables"}
seatbelts%>% 
  ggpairs()+
  ggtitle("Correlation between variables")
```
- I use the GGally package to produce the correlation graph 
- The figure \@ref(fig:ggpairs) shows that there are positive relationships between drivers variable and Driverskilled variable, front variable and Driverskilled variable, rear variable and Driverskilled variable.
- it also indicates that the relationships between kms and Driverskilled variable, PetrolPrice and Driverskilled , VanKilled and Driverskilled, and law and Driverskilled are negative.





{Section 3}
