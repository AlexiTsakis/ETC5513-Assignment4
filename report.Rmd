---
title: "Assignment 3 ggplot2"
author:
- familyname: Li
  othernames: Siyi
  address: Monash Universty
  email: "slii0048@student.monash.edu"
  correspondingauthor: true
  qualifications: 29018102
- familyname: Wang
  othernames: Yusen
  address: Monash Universty
  email: "ywa136@student.monash.edu"
  correspondingauthor: true
  qualifications: 27496538
- familyname: Tsakis
  othernames: Alexi
  address: Monash Universty
  email: "atsa0003@student.monash.edu"
  correspondingauthor: true
  qualifications: 29682525
department: Our consultancy \newline Alexi  &\newline Siyi  &\newline Yusen
organization: Australian Government
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    latex_engine: lualatex
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
    in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r , echo = FALSE, include=FALSE, message = FALSE, warning = FALSE}
# Libraries
set.seed(96024)

library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(fig.pos = 'H', echo = FALSE, message = FALSE, warning = FALSE)
```

# Introduction

In this report we look at data from various countries around the world, this data includes the following:

  1. Country_Name: The name of the country where the data was retrieved from.
  
  2. Year: The year this observation was recorded.
  
  3. Region: The region the country is in.
  
  4. Income: The rough income bracket of the country, split into low, low middle, upper middle and high.
  
  5. CO2_emissions_metric_tons_per_capita: The carbon dioxide emissions of the country, in metric tons, divided by the population.
  
  6. Urban Population: The number of people that live in urban areas.
  
  7. Energy_use_kg_of_oil_equivalent_per_capita: The amount of energy the country uses, in the equivalent of kilograms of oil, divided by the population.



\clearpage

\section*{ Country "China" and "Singapore" }

```{r read_data}
data<-read.csv("Data/Assignment3_data.csv")
```

```{r select_countries}
data%>%
  filter(Country_Name %in% c("China","Singapore"))->mydata

```

# Questions
- Is there any relationships between urban population and time for the 2 selected countries? In other words, will there be more and more urban population over time for the 2 selected countries.

- Is there any patterns of CO2 emissions over the year for the 2 selected countries?


# Analysis 

```{r line, fig.cap="Line graph for both countries"}
mydata%>%
  filter(Country_Name=="China")%>%
  ggplot(aes(x=Year, y=Urban_population))+
  geom_line()+
  ggtitle("Urban population of China")->p1

mydata%>%
  filter(Country_Name=="Singapore")%>%
  ggplot(aes(x=Year, y=Urban_population))+
  geom_line()+
  ggtitle("Urban population of Singapore")->p2

library(gridExtra)
grid.arrange(p1, p2)

```

Figure \@ref(fig:line) indicates that there is an increasing trend of urban population over years for China and Singapore. In other words, there are more and more urban population over time for both countries.

\clearpage

```{r CO2summary}
mydata%>%
  filter(!is.na(CO2_emissions_metric_tons_per_capita))%>%
  select(CO2_emissions_metric_tons_per_capita)%>%
  summary()%>%
  kable(caption = "Summary of CO2 emissions per capita")%>%
  kable_styling(bootstrap_options = c("bordered", "hover"))
```

Table \@ref(tab:CO2summary) shows that the minimum CO2 emissions metric tons per capita is 0.3488 and the maximum is 18.0409. The mean value of CO2 emissions metric tons per capita is 6.1101.


```{r barcharts, fig.cap="Bar chart for both countries"}
mydata%>%
  filter(Country_Name=="China", !is.na(CO2_emissions_metric_tons_per_capita), !is.na(Urban_population))%>%
  mutate(total=CO2_emissions_metric_tons_per_capita*Urban_population)%>%
  ggplot(aes(y=total, x=Year))+
  geom_col()+
  ggtitle("CO2 emmisions of China")->p3

mydata%>%
  filter(Country_Name=="Singapore", !is.na(CO2_emissions_metric_tons_per_capita), !is.na(Urban_population))%>%
  mutate(total=CO2_emissions_metric_tons_per_capita*Urban_population)%>%
  ggplot(aes(y=total, x=Year))+
  geom_col()+
  ggtitle("CO2 emmisions of singapore")->p4

library(gridExtra)
grid.arrange(p3, p4)
```

We want to determine the relationships about the total CO2 emissions over years for each country. Since the variable of CO2 emissions is measured in metric tons per capita, we should calculate the total CO2 emissions via multiplying CO2_emissions_metric_tons_per_capita by Urban_population.

The figure \@ref(fig:barcharts) shows that there is an increasing trend of total CO2 emissions over the year in China. compared with that, Singapore have some fluctuations during those years. Especially, there is a decreasing after around 1995. 

\clearpage


\section*{Country "Brazil" and "Japan"}

# Questions
In this section, the effects of Co2 emissions over years in Japan and Brazil will be observed. There are two main questions will be focused on:

- What is the difference in CO2 emissions between developed and developing countries over time？

- Compared to the past, the trend of emissions in both countries has been increasing or not？

```{r, echo = FALSE, message= FALSE, warning= FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r Load_data for selected countries}
data_second<-read.csv("Data/Assignment3_data.csv")
data_second%>% filter(Country_Name %in% c("Japan", "Brazil")) -> data_second2
```

# Analysis
## Comparing the population over years between Japan and Brazil

```{r figure1, fig.cap="Line graph for urban population trend of both countries"}
data_second2%>%
  ggplot(aes(y=Urban_population, x=Year,col=Country_Name))+
  geom_line()
```

Figure \@ref(fig:figure1) shows that the urban population of Brazil has already surpassed Japanese Urban population after 1985. Since the 20th century, Japan has entered a post-industrial society, reduce fertility and always strictly controlled immigration, that is why Japan's total population and working population growth is slow even be shrinking to current day.

\clearpage

## Observing Japan and Brazil CO2 emission trend over years

```{r figure2, fig.cap="CO2 emission "}
data_second2%>%
  filter(Country_Name=="Brazil")%>%
  ggplot(aes(y=CO2_emissions_metric_tons_per_capita, x=Year))+
  geom_line()+
  ggtitle("CO2 emission of Brazil")->plot1

data_second2%>%
  filter(Country_Name=="Japan")%>%
  ggplot(aes(y=CO2_emissions_metric_tons_per_capita, x=Year))+
  geom_line()+
  ggtitle("CO2 emission of Japan")->plot2

library(gridExtra)
grid.arrange(plot1, plot2)
```

According to Figure \@ref(fig:figure2) We can see that Japan's growth slowed sharply from 1875 and has remained at around 9 units since then. Brazil is growing fast, but its CO2 per emissions capita are consistently a quarter of those of Japan. One of the reasons is demographic (\cite{7}).  As mentioned before, Japan's population is always on the verge of aging
\clearpage


```{r values}
 data_second2%>% 
 filter(!is.na(CO2_emissions_metric_tons_per_capita))%>% 
 select(CO2_emissions_metric_tons_per_capita)%>% 
 summary()%>% 
 kable(caption = "Mathematical Value")%>% 
 kable_styling(bootstrap_options = c("striped", "hover")) 
```


Table \@ref(tab:values) shows that the minimum valuea is 0.6499 and the maximum is 9.9092.  Without a huge gap in population, the carbon emissions of developed countries would be far higher than those of developing countries. Because of its level of urbanization, industrialization and GDP. (\cite{8})

\clearpage
 
\section*{Country "Kenya" and "Seychelles"}
# Questions

In this section, using data from the countries of Kenya and Seychelles, we aim to answer the following two questions; What is the effect of wealth on population growth and carbon emissions in a country?

"In wealthier societies, there is less need for producing children" (\cite{6}), meaning that we would expect the wealthier country (in this case, Seychelles) to have slower population growth than Kenya. Looking at our data

# Analysis
```{r , echo = FALSE, include=FALSE, message = FALSE, warning = FALSE}
data = read.csv("data/Assignment3_data.csv")
data_filter = data %>%
  filter(Country_Name %in% c("Kenya","Seychelles")) %>%
  mutate(pop_growth =100*(Urban_population-lag(Urban_population))/lag(Urban_population)) %>%
  filter(Year>1960)

ks_pop_plot = ggplot(data=data_filter, aes(x=Year,y=pop_growth,col=Country_Name))+geom_line()
ks_co2_plot = ggplot(data=data_filter, aes(x=Year,y=CO2_emissions_metric_tons_per_capita,col=Country_Name))+geom_line()

#comparisons to other countries
data_africa = data %>%
  filter(Region == "Sub-Saharan Africa") %>%
  mutate(pop_growth =100*(Urban_population-lag(Urban_population))/lag(Urban_population)) %>%
  drop_na()

Africa_CO2 = data_africa %>%
  group_by(IncomeGroup) %>%
  summarise(CO2=mean(CO2_emissions_metric_tons_per_capita)) %>%
  arrange(CO2)

KS_CO2 = data_filter %>%
  drop_na() %>%
  group_by(Country_Name) %>%
  summarise(CO2=mean(CO2_emissions_metric_tons_per_capita))

Africa_Pop = data_africa %>%
  group_by(IncomeGroup) %>%
  summarise(pop_grow=mean(pop_growth)) %>%
  arrange(pop_grow)

KS_Pop = data_filter %>%
  group_by(Country_Name) %>%
  summarise(pop_grow=mean(pop_growth))
```

```{r ks-pop, fig.cap = "Population plot for Kenya and Seychelles"}
ks_pop_plot
```

We can see that the population growth in Seychelles (figure \@ref(fig:ks-pop)) in significantly slower. This is further backed by comparing our two countries to the rest of Sub-Saharan Africa
\clearpage

```{r pop-tables1}
kable(Africa_Pop, caption="Sub-Saharan Africa population growth")
```

```{r pop-tables2}
kable(KS_Pop, caption="Kenya and Seychelles population growth")
```

Which clearly demonstrates a negative correlation between income and population growth (table \@ref(tab:pop-tables1) & \@ref(tab:pop-tables2)). Another factor for this could be that our population metric is urban growth - and as a country becomes wealthier, more of its urban environment tends to be populated, so there is less room for growth.
\clearpage

The reverse is true for carbon emissions - \cite{5} found that rising income inequality was compounded by a lack of public attention focused on the environment. Looking at our data

```{r ks-co2, fig.cap="CO2 plot for Kenya and Seychelles"}
ks_co2_plot
```

We can see the wealthier country has a significantly higher CO2 output per capita (figure \@ref(fig:ks-co2)), and comparing it to the rest of Sub-Saharan Africa
\clearpage

```{r co2-tables1}
kable(Africa_CO2, caption = "Sub-Saharan Africa CO2 Emissions")
```

```{r co2-tables2}
kable(KS_CO2, caption = "Kenya and Seychelles CO2 Emissions")
```

We can see there is clearly a positive correlation between income and CO2 emissions per capita (table \@ref(tab:co2-tables1) & \@ref(tab:co2-tables2)).

-----

Packages used: tidyverse (\cite{1}), readr(\cite{2}), kableExtra(\cite{3}), bookdown(\cite{4})
